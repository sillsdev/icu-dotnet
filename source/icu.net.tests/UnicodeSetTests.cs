// Copyright (c) 2013-2025 SIL Global
// This software is licensed under the MIT license (http://opensource.org/licenses/MIT)
using System;
using System.Collections.Generic;
using System.Linq;
using NUnit.Framework;

namespace Icu.Tests
{
	[TestFixture]
	public class UnicodeSetTests
	{
		[TestCase(null, // new[] {}
			ExpectedResult = "[]")]
		[TestCase("", // new[] { "" }
			ExpectedResult = "[]")]
		[TestCase("A B C D E F G H I J K L M N O P Q R S TZ T U V W X Y Z",
			ExpectedResult = "[A-Z{TZ}]")]
		[TestCase("Î± Î‘ Î±Ì Î±Ì€ Î±Í‚Í… Î±Ì“ Î‘Ì“ Î±Ì” Î‘Ì” Î±Ì“Ì Î‘Ì“Ì Î±Ì“Ì€ Î±Ì”Ì Î‘Ì”Ì Î±Ì”Ì€ Î‘Ì”Ì€ Î±Í‚ Î±Í… Î±ÌÍ… Î±Ì“Í‚ Î‘Ì“Í‚ Î±Ì“ÌÍ… Î±Ì”ÌÍ… Î² Î’ Î³ Î“ Î´ Î” Îµ Î• ÎµÌ ÎµÌ€ ÎµÌ“ Î•Ì“ ÎµÌ” Î•Ì” ÎµÌ“Ì Î•Ì“Ì ÎµÌ”Ì Î•Ì”Ì ÎµÌ”Ì€ Î•Ì”Ì€ Î¶ Î– Î· Î— Î·Ì Î·Ì€ Î·Í‚Í… Î·Ì“ Î—Ì“ Î·Ì” Î—Ì” Î·Ì“Ì Î—Ì“Ì Î·Ì“Ì€ Î·Ì”Ì Î—Ì”Ì Î—Ì“Ì€ Î·Ì”Ì€ Î·Ì”Í‚Í… Î·Í‚ Î·Í… Î·ÌÍ… Î·Ì“Í‚ Î—Ì“Í‚ Î·Ì“Í‚Í… Î·Ì”Í‚ Î·Ì“Í… Î·Ì”Í… Î·Ì“ÌÍ… Î¸ Î˜ Î¹ Î¹Ì Î¹Ì€ Î¹Ìˆ Î¹ÌˆÌ Î¹ÌˆÌ€ Î¹Ì“ Î™Ì“ Î¹Ì” Î™Ì” Î¹Ì“Ì Î™Ì“Ì Î¹Ì”Ì Î™Ì”Ì Î¹Ì”Ì€ Î¹Í‚ Î¹Ì“Í‚ Î¹Ì”Í‚ Îº Îš Î» Î› Î¼ Îœ Î½ Î Î¾ Î Î¿ ÎŸ Î¿Ì Î¿Ì€ Î¿Ì“ ÎŸÌ“ Î¿Ì” ÎŸÌ” Î¿Ì“Ì ÎŸÌ“Ì Î¿Ì”Ì Î¿Ì“Ì€ ÎŸÌ”Ì Î¿Ì”Ì€ ÎŸÌ”Ì€ Ï€ Î  Ï Î¡ ÏÌ” Î¡Ì” Ïƒ Ï‚ Î£ Ï„ Î¤ Ï… Î¥ Ï…Ì Ï…Ì€ Ï…Ìˆ Ï…ÌˆÌ Ï…ÌˆÌ€ Ï…Ì“ Ï…Ì” Î¥Ì” Ï…Ì“Ì Ï…Ì”Ì Ï…Ì“Ì€ Î¥Ì”Ì Ï…Ì”Ì€ Ï…Í‚ Ï…Ì“Í‚ Ï…Ì”Í‚ Î¥Ì”Í‚ Ï† Î¦ Ï‡ Î§ Ïˆ Î¨ Ï‰ Ï‰Ì Ï‰Ì€ Ï‰Í‚Í… Ï‰Ì“ Ï‰Ì” Î©Ì” Ï‰Ì“Ì Î©Ì“Ì Ï‰Ì“Ì€ Ï‰Ì”Ì Î©Ì”Ì Ï‰Ì”Í‚Í… Ï‰Í‚ Ï‰Í… Ï‰ÌÍ… Ï‰Ì“Í‚ Î©Ì“Í‚ Ï‰Ì”Í‚ Î©Ì”Í‚ Ï‰Ì“Í…",
			ExpectedResult = @"[\u0391-\u0398\u039A-\u03A1\u03A3-\u03A8\u03B1-\u03C9{\u0391\u0313}{\u0391\u0313\u0301}{\u0391\u0313\u0342}{\u0391\u0314}{\u0391\u0314\u0300}{\u0391\u0314\u0301}{\u0395\u0313}{\u0395\u0313\u0301}{\u0395\u0314}{\u0395\u0314\u0300}{\u0395\u0314\u0301}{\u0397\u0313}{\u0397\u0313\u0300}{\u0397\u0313\u0301}{\u0397\u0313\u0342}{\u0397\u0314}{\u0397\u0314\u0301}{\u0399\u0313}{\u0399\u0313\u0301}{\u0399\u0314}{\u0399\u0314\u0301}{\u039F\u0313}{\u039F\u0313\u0301}{\u039F\u0314}{\u039F\u0314\u0300}{\u039F\u0314\u0301}{\u03A1\u0314}{\u03A5\u0314}{\u03A5\u0314\u0301}{\u03A5\u0314\u0342}{\u03A9\u0313\u0301}{\u03A9\u0313\u0342}{\u03A9\u0314}{\u03A9\u0314\u0301}{\u03A9\u0314\u0342}{\u03B1\u0300}{\u03B1\u0301}{\u03B1\u0301\u0345}{\u03B1\u0313}{\u03B1\u0313\u0300}{\u03B1\u0313\u0301}{\u03B1\u0313\u0301\u0345}{\u03B1\u0313\u0342}{\u03B1\u0314}{\u03B1\u0314\u0300}{\u03B1\u0314\u0301}{\u03B1\u0314\u0301\u0345}{\u03B1\u0342}{\u03B1\u0342\u0345}{\u03B1\u0345}{\u03B5\u0300}{\u03B5\u0301}{\u03B5\u0313}{\u03B5\u0313\u0301}{\u03B5\u0314}{\u03B5\u0314\u0300}{\u03B5\u0314\u0301}{\u03B7\u0300}{\u03B7\u0301}{\u03B7\u0301\u0345}{\u03B7\u0313}{\u03B7\u0313\u0300}{\u03B7\u0313\u0301}{\u03B7\u0313\u0301\u0345}{\u03B7\u0313\u0342}{\u03B7\u0313\u0342\u0345}{\u03B7\u0313\u0345}{\u03B7\u0314}{\u03B7\u0314\u0300}{\u03B7\u0314\u0301}{\u03B7\u0314\u0342}{\u03B7\u0314\u0342\u0345}{\u03B7\u0314\u0345}{\u03B7\u0342}{\u03B7\u0342\u0345}{\u03B7\u0345}{\u03B9\u0300}{\u03B9\u0301}{\u03B9\u0308}{\u03B9\u0308\u0300}{\u03B9\u0308\u0301}{\u03B9\u0313}{\u03B9\u0313\u0301}{\u03B9\u0313\u0342}{\u03B9\u0314}{\u03B9\u0314\u0300}{\u03B9\u0314\u0301}{\u03B9\u0314\u0342}{\u03B9\u0342}{\u03BF\u0300}{\u03BF\u0301}{\u03BF\u0313}{\u03BF\u0313\u0300}{\u03BF\u0313\u0301}{\u03BF\u0314}{\u03BF\u0314\u0300}{\u03BF\u0314\u0301}{\u03C1\u0314}{\u03C5\u0300}{\u03C5\u0301}{\u03C5\u0308}{\u03C5\u0308\u0300}{\u03C5\u0308\u0301}{\u03C5\u0313}{\u03C5\u0313\u0300}{\u03C5\u0313\u0301}{\u03C5\u0313\u0342}{\u03C5\u0314}{\u03C5\u0314\u0300}{\u03C5\u0314\u0301}{\u03C5\u0314\u0342}{\u03C5\u0342}{\u03C9\u0300}{\u03C9\u0301}{\u03C9\u0301\u0345}{\u03C9\u0313}{\u03C9\u0313\u0300}{\u03C9\u0313\u0301}{\u03C9\u0313\u0342}{\u03C9\u0313\u0345}{\u03C9\u0314}{\u03C9\u0314\u0301}{\u03C9\u0314\u0342}{\u03C9\u0314\u0342\u0345}{\u03C9\u0342}{\u03C9\u0342\u0345}{\u03C9\u0345}]")]
		public string ToPattern(string input)
		{
			return UnicodeSet.ToPattern(input?.Split(' ') ?? new string[]{});
		}

		[Test]
		public void NullToPattern()
		{
			Assert.That(() => UnicodeSet.ToPattern(null), Throws.TypeOf<ArgumentNullException>());
		}

		[TestCase("[A]",
			ExpectedResult = new[] { "A" })]
		[TestCase("[A-GH-NO-ST-Z{TZ}]",
			ExpectedResult = new[] { "A", "B", "C", "D", "E", "F", "G", "H", "I", "J", "K", "L", "M", "N", "O", "P", "Q", "R", "S", "T", "U", "V", "W", "X", "Y", "Z", "TZ" })]
		[TestCase(@"[\u0391-\u0398\u039A-\u03A1\u03A3-\u03A8\u03B1-\u03C9{\u0391\u0313}{\u0391\u0313\u0301}{\u0391\u0313\u0342}{\u0391\u0314}{\u0391\u0314\u0300}{\u0391\u0314\u0301}{\u0395\u0313}{\u0395\u0313\u0301}{\u0395\u0314}{\u0395\u0314\u0300}{\u0395\u0314\u0301}{\u0397\u0313}{\u0397\u0313\u0300}{\u0397\u0313\u0301}{\u0397\u0313\u0342}{\u0397\u0314}{\u0397\u0314\u0301}{\u0399\u0313}{\u0399\u0313\u0301}{\u0399\u0314}{\u0399\u0314\u0301}{\u039F\u0313}{\u039F\u0313\u0301}{\u039F\u0314}{\u039F\u0314\u0300}{\u039F\u0314\u0301}{\u03A1\u0314}{\u03A5\u0314}{\u03A5\u0314\u0301}{\u03A5\u0314\u0342}{\u03A9\u0313\u0301}{\u03A9\u0313\u0342}{\u03A9\u0314}{\u03A9\u0314\u0301}{\u03A9\u0314\u0342}{\u03B1\u0300}{\u03B1\u0301}{\u03B1\u0301\u0345}{\u03B1\u0313}{\u03B1\u0313\u0300}{\u03B1\u0313\u0301}{\u03B1\u0313\u0301\u0345}{\u03B1\u0313\u0342}{\u03B1\u0314}{\u03B1\u0314\u0300}{\u03B1\u0314\u0301}{\u03B1\u0314\u0301\u0345}{\u03B1\u0342}{\u03B1\u0342\u0345}{\u03B1\u0345}{\u03B5\u0300}{\u03B5\u0301}{\u03B5\u0313}{\u03B5\u0313\u0301}{\u03B5\u0314}{\u03B5\u0314\u0300}{\u03B5\u0314\u0301}{\u03B7\u0300}{\u03B7\u0301}{\u03B7\u0301\u0345}{\u03B7\u0313}{\u03B7\u0313\u0300}{\u03B7\u0313\u0301}{\u03B7\u0313\u0301\u0345}{\u03B7\u0313\u0342}{\u03B7\u0313\u0342\u0345}{\u03B7\u0313\u0345}{\u03B7\u0314}{\u03B7\u0314\u0300}{\u03B7\u0314\u0301}{\u03B7\u0314\u0342}{\u03B7\u0314\u0342\u0345}{\u03B7\u0314\u0345}{\u03B7\u0342}{\u03B7\u0342\u0345}{\u03B7\u0345}{\u03B9\u0300}{\u03B9\u0301}{\u03B9\u0308}{\u03B9\u0308\u0300}{\u03B9\u0308\u0301}{\u03B9\u0313}{\u03B9\u0313\u0301}{\u03B9\u0313\u0342}{\u03B9\u0314}{\u03B9\u0314\u0300}{\u03B9\u0314\u0301}{\u03B9\u0314\u0342}{\u03B9\u0342}{\u03BF\u0300}{\u03BF\u0301}{\u03BF\u0313}{\u03BF\u0313\u0300}{\u03BF\u0313\u0301}{\u03BF\u0314}{\u03BF\u0314\u0300}{\u03BF\u0314\u0301}{\u03C1\u0314}{\u03C5\u0300}{\u03C5\u0301}{\u03C5\u0308}{\u03C5\u0308\u0300}{\u03C5\u0308\u0301}{\u03C5\u0313}{\u03C5\u0313\u0300}{\u03C5\u0313\u0301}{\u03C5\u0313\u0342}{\u03C5\u0314}{\u03C5\u0314\u0300}{\u03C5\u0314\u0301}{\u03C5\u0314\u0342}{\u03C5\u0342}{\u03C9\u0300}{\u03C9\u0301}{\u03C9\u0301\u0345}{\u03C9\u0313}{\u03C9\u0313\u0300}{\u03C9\u0313\u0301}{\u03C9\u0313\u0342}{\u03C9\u0313\u0345}{\u03C9\u0314}{\u03C9\u0314\u0301}{\u03C9\u0314\u0342}{\u03C9\u0314\u0342\u0345}{\u03C9\u0342}{\u03C9\u0342\u0345}{\u03C9\u0345}]",
			ExpectedResult = new[] { "Î‘", "Î’", "Î“", "Î”", "Î•", "Î–", "Î—", "Î˜", "Îš", "Î›", "Îœ", "Î", "Î", "ÎŸ", "Î ", "Î¡", "Î£", "Î¤", "Î¥", "Î¦", "Î§", "Î¨", "Î±", "Î²", "Î³", "Î´", "Îµ", "Î¶", "Î·", "Î¸", "Î¹", "Îº", "Î»", "Î¼", "Î½", "Î¾", "Î¿", "Ï€", "Ï", "Ï‚", "Ïƒ", "Ï„", "Ï…", "Ï†", "Ï‡", "Ïˆ", "Ï‰", "Î‘Ì“", "Î‘Ì“Ì", "Î‘Ì“Í‚", "Î‘Ì”", "Î‘Ì”Ì€", "Î‘Ì”Ì", "Î•Ì“", "Î•Ì“Ì", "Î•Ì”", "Î•Ì”Ì€", "Î•Ì”Ì", "Î—Ì“", "Î—Ì“Ì€", "Î—Ì“Ì", "Î—Ì“Í‚", "Î—Ì”", "Î—Ì”Ì", "Î™Ì“", "Î™Ì“Ì", "Î™Ì”", "Î™Ì”Ì", "ÎŸÌ“", "ÎŸÌ“Ì", "ÎŸÌ”", "ÎŸÌ”Ì€", "ÎŸÌ”Ì", "Î¡Ì”", "Î¥Ì”", "Î¥Ì”Ì", "Î¥Ì”Í‚", "Î©Ì“Ì", "Î©Ì“Í‚", "Î©Ì”", "Î©Ì”Ì", "Î©Ì”Í‚", "Î±Ì€", "Î±Ì", "Î±ÌÍ…", "Î±Ì“", "Î±Ì“Ì€", "Î±Ì“Ì", "Î±Ì“ÌÍ…", "Î±Ì“Í‚", "Î±Ì”", "Î±Ì”Ì€", "Î±Ì”Ì", "Î±Ì”ÌÍ…", "Î±Í‚", "Î±Í‚Í…", "Î±Í…", "ÎµÌ€", "ÎµÌ", "ÎµÌ“", "ÎµÌ“Ì", "ÎµÌ”", "ÎµÌ”Ì€", "ÎµÌ”Ì", "Î·Ì€", "Î·Ì", "Î·ÌÍ…", "Î·Ì“", "Î·Ì“Ì€", "Î·Ì“Ì", "Î·Ì“ÌÍ…", "Î·Ì“Í‚", "Î·Ì“Í‚Í…", "Î·Ì“Í…", "Î·Ì”", "Î·Ì”Ì€", "Î·Ì”Ì", "Î·Ì”Í‚", "Î·Ì”Í‚Í…", "Î·Ì”Í…", "Î·Í‚", "Î·Í‚Í…", "Î·Í…", "Î¹Ì€", "Î¹Ì", "Î¹Ìˆ", "Î¹ÌˆÌ€", "Î¹ÌˆÌ", "Î¹Ì“", "Î¹Ì“Ì", "Î¹Ì“Í‚", "Î¹Ì”", "Î¹Ì”Ì€", "Î¹Ì”Ì", "Î¹Ì”Í‚", "Î¹Í‚", "Î¿Ì€", "Î¿Ì", "Î¿Ì“", "Î¿Ì“Ì€", "Î¿Ì“Ì", "Î¿Ì”", "Î¿Ì”Ì€", "Î¿Ì”Ì", "ÏÌ”", "Ï…Ì€", "Ï…Ì", "Ï…Ìˆ", "Ï…ÌˆÌ€", "Ï…ÌˆÌ", "Ï…Ì“", "Ï…Ì“Ì€", "Ï…Ì“Ì", "Ï…Ì“Í‚", "Ï…Ì”", "Ï…Ì”Ì€", "Ï…Ì”Ì", "Ï…Ì”Í‚", "Ï…Í‚", "Ï‰Ì€", "Ï‰Ì", "Ï‰ÌÍ…", "Ï‰Ì“", "Ï‰Ì“Ì€", "Ï‰Ì“Ì", "Ï‰Ì“Í‚", "Ï‰Ì“Í…", "Ï‰Ì”", "Ï‰Ì”Ì", "Ï‰Ì”Í‚", "Ï‰Ì”Í‚Í…", "Ï‰Í‚", "Ï‰Í‚Í…", "Ï‰Í…" })]
		public IEnumerable<string> ToCharacters(string pattern)
		{
			return UnicodeSet.ToCharacters(pattern);
		}

		[TestCase(null)]
		[TestCase("[]")]
		public void ToCharacters_Null(string pattern)
		{
			Assert.That(UnicodeSet.ToCharacters(pattern), Is.EqualTo(Enumerable.Empty<string>()));
		}

		[Test]
		public void ToCharacters_InvalidPattern()
		{
			Assert.That(() => UnicodeSet.ToCharacters("[A-"), Throws.ArgumentException);
		}

		[Test]
		public void ToCharacters_UpperPlane()
		{
			string pattern = @"[\U00010D00]";
			string strForUpperPlaneCharacter = UnicodeSet.ToCharacters(pattern).First();
			Assert.That(strForUpperPlaneCharacter, Is.EqualTo("ğ´€"));
			Assert.That(char.ConvertToUtf32(strForUpperPlaneCharacter, 0), Is.EqualTo(0x00010D00));
		}
	}
}
